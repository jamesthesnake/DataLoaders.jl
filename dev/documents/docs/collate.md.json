{"attributes":{"backlinks":[{"tag":"document","title":"toc","docid":"documents/toc.md"},{"tag":"documentation","title":"collate","docid":"references/DataLoaders.collate"},{"tag":"document","title":"DataLoaders.jl","docid":"documents/README.md"},{"tag":"documentation","title":"DataLoader","docid":"references/DataLoaders.DataLoader"}],"path":"/home/runner/.julia/packages/DataLoaders/e6aWr/docs/collate.md","title":"Collating"},"tag":"document","children":[{"attributes":{},"tag":"h1","children":[{"mimes":{"text/plain":"Collating"}}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"Collating refers to combining a batch of observations so that the arrays in individual observations are stacked together"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" As an example, consider a dataset with 100 observations, each with 2 features"}},{"mimes":{"text/plain":"."}}]},{"attributes":{"result":"false","class":"cellcontainer","cell":"main","lang":"julia"},"tag":"div","children":[{"attributes":{"result":"false","class":"codecell","cell":"main","lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"data"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"rand"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"2"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"100"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")  # observation dimension is last by default"}}]}]}]}]}]},{"mimes":{"text/plain":""}},{"mimes":{"text/plain":""}}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"We can collect a batch of 4 observations into a vector as follows:"}}]},{"attributes":{"class":"cellcontainer","cell":"main","lang":"julia"},"tag":"div","children":[{"attributes":{"class":"codecell","cell":"main","lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_using","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"using"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{"reftype":"symbol","document_id":"references/DataLoaders"},"tag":"reference","children":[{"mimes":{"text/plain":"DataLoaders"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":"\n"}}]}]}]}]}]},{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"batch"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_comprehension","children":[{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"["}}]},{"attributes":{},"tag":"CST_generator","children":[{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"getobs"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"data"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"i"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":") "}}]}]},{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"for"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"i"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"in "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"1"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":":"}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"4"}}]}]}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"]"}}]}]}]}]}]},{"mimes":{"text/plain":""}},{"attributes":{"class":"coderesult"},"tag":"pre","children":[{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"4-element Vector{Vector{Float64}}:\n [0.45354194148568827, 0.49676051076907535]\n [0.07908169953276656, 0.12387643337513088]\n [0.14920684700098896, 0.20777816736694354]\n [0.6762783801504838, 0.18255622011527195]"}}]}]}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"Many machine learning models, however, expect an input in a "}},{"attributes":{},"tag":"em","children":[{"mimes":{"text/plain":"collated"}}]},{"mimes":{"text/plain":" format: instead of a nested vector of vectors, we need a single ND"}},{"mimes":{"text/plain":"-"}},{"mimes":{"text/plain":"array"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" DataLoaders"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":"jl provides the "}},{"attributes":{"reftype":"symbol","document_id":"references/DataLoaders.collate"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"collate"}}]}]},{"mimes":{"text/plain":" function for this:"}}]},{"attributes":{"class":"cellcontainer","cell":"main","lang":"julia"},"tag":"div","children":[{"attributes":{"class":"codecell","cell":"main","lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{"reftype":"symbol","document_id":"references/DataLoaders"},"tag":"reference","children":[{"mimes":{"text/plain":"DataLoaders"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"CST_quotenode","children":[{"attributes":{"reftype":"symbol","document_id":"references/DataLoaders.collate"},"tag":"reference","children":[{"mimes":{"text/plain":"collate"}}]}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"batch"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]}]}]},{"mimes":{"text/plain":""}},{"attributes":{"class":"coderesult"},"tag":"pre","children":[{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"2Ã—4 Matrix{Float64}:\n 0.453542  0.0790817  0.149207  0.676278\n 0.496761  0.123876   0.207778  0.182556"}}]}]}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"As you can see, the batch dimension is the last one by default"}},{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"h2","children":[{"mimes":{"text/plain":"Nested observations"}}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"The above case only shows how to collate observations that each consist of a single array"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" In practice, however, observations will often consist of multiple variables like input features and a target variable"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" For example, we could have an integer indicating the class of an input sample"}},{"mimes":{"text/plain":"."}}]},{"attributes":{"class":"cellcontainer","cell":"main","lang":"julia"},"tag":"div","children":[{"attributes":{"class":"codecell","cell":"main","lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"inputs"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"rand"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"2"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"100"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n"}}]}]}]}]},{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"targets"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"rand"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"1"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":":"}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"10"}}]}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"100"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n"}}]}]}]}]},{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"data"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_tuple","children":[{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"inputs"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"targets"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n"}}]}]}]}]},{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"batch"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_comprehension","children":[{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"["}}]},{"attributes":{},"tag":"CST_generator","children":[{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"getobs"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"data"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"i"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":") "}}]}]},{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"for"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"i"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"in "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"1"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":":"}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"4"}}]}]}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"]"}}]}]}]}]}]},{"mimes":{"text/plain":""}},{"attributes":{"class":"coderesult"},"tag":"pre","children":[{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"4-element Vector{Tuple{Vector{Float64}, Int64}}:\n ([0.9406691471237981, 0.8245877897588818], 2)\n ([0.6531689044084074, 0.2632500929696038], 8)\n ([0.5958419638493433, 0.8184034760982978], 3)\n ([0.7250912330017997, 0.8440952440818814], 8)"}}]}]}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"Collating here also works, by keeping the tuple structure and collating each element separately:"}}]},{"attributes":{"class":"cellcontainer","cell":"main","lang":"julia"},"tag":"div","children":[{"attributes":{"class":"codecell","cell":"main","lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{"reftype":"symbol","document_id":"references/DataLoaders"},"tag":"reference","children":[{"mimes":{"text/plain":"DataLoaders"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"CST_quotenode","children":[{"attributes":{"reftype":"symbol","document_id":"references/DataLoaders.collate"},"tag":"reference","children":[{"mimes":{"text/plain":"collate"}}]}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"batch"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]}]}]},{"mimes":{"text/plain":""}},{"attributes":{"class":"coderesult"},"tag":"pre","children":[{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"([0.9406691471237981 0.6531689044084074 0.5958419638493433 0.7250912330017997; 0.8245877897588818 0.2632500929696038 0.8184034760982978 0.8440952440818814], [2, 8, 3, 8])"}}]}]}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"This is also implemented for "}},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"NamedTuple"}}]},{"mimes":{"text/plain":"s and "}},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"Dict"}}]},{"mimes":{"text/plain":"s"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" You can also collate nested structures, e"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":"g"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" a "}},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"Tuple"}}]},{"mimes":{"text/plain":" of "}},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"Dict"}}]},{"mimes":{"text/plain":"s and the structure is preserved"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" This also works when using "}},{"attributes":{"reftype":"document","href":"inplaceloading.md","title":"","document_id":"documents/docs/inplaceloading.md"},"tag":"reference","children":[{"mimes":{"text/plain":"inplace loading"}}]},{"mimes":{"text/plain":"."}}]}]}