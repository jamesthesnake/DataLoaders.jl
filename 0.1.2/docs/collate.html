<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="generator" content="Publish.jl" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="" />
    <title>DataLoaders.jl</title>
    <link rel="stylesheet" href="..&#x2F;normalize.css" />
    <link rel="stylesheet" href="..&#x2F;tabulator_simple.min.css" />
    <link rel="stylesheet" href="..&#x2F;publish.css" />
    <link rel="stylesheet" href="..&#x2F;default.min.css" />
    <script src="..&#x2F;versions.js"></script>
    <script src="..&#x2F;lunr.js"></script>
    <script src="..&#x2F;highlight.min.js"></script>
    <script src="..&#x2F;tabulator.min.js"></script>
    <script src="..&#x2F;julia.min.js"></script>
    <script src="..&#x2F;julia-repl.min.js"></script>
    <script src="..&#x2F;publish.js"></script>
    <link rel="stylesheet" href="custom.css" />
    
</head>
<body>
    <div class="menu">
        <svg id="menu-toggler" title="Contents" onclick="toggleIndexPage();" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6C2 5.44772 2.44772 5 3 5H21C21.5523 5 22 5.44772 22 6C22 6.55228 21.5523 7 21 7H3C2.44772 7 2 6.55228 2 6Z" fill="currentColor" /><path d="M2 12.0322C2 11.4799 2.44772 11.0322 3 11.0322H21C21.5523 11.0322 22 11.4799 22 12.0322C22 12.5845 21.5523 13.0322 21 13.0322H3C2.44772 13.0322 2 12.5845 2 12.0322Z" fill="currentColor" /><path d="M3 17.0645C2.44772 17.0645 2 17.5122 2 18.0645C2 18.6167 2.44772 19.0645 3 19.0645H21C21.5523 19.0645 22 18.6167 22 18.0645C22 17.5122 21.5523 17.0645 21 17.0645H3Z" fill="currentColor" /></svg>
        <input id="search-input" placeholder="Search">
        <select id="version-selector"></select>
    </div>
    <main id="page"><article><h1 id="collating"><a href="#collating" class="anchor"></a>Collating</h1>
<p>Collating refers to combining a batch of observations so that the arrays in individual observations are stacked together. As an example, consider a dataset with 100 observations, each with 2 features.</p>
<pre><code cell="main" result="false" class="language-julia">data = rand(2, 100)  # observation dimension is last by default
</code></pre>
<p>We can collect a batch of 4 observations into a vector as follows:</p>
<pre><code cell="main" class="language-julia">using DataLoaders
batch = [getobs(data, i) for i in 1:4]
</code></pre>
<pre><code class="plaintext cell-output cell-result" class="language-plaintext">4-element Array{Array{Float64,1},1}:
 [0.2170232542463284, 0.4000194246665476]
 [0.24210250257151467, 0.7007577015053201]
 [0.18485249599884157, 0.6125899921808304]
 [0.35876194944689765, 0.584284023437533]</code></pre>
<p>Many machine learning models, however, expect an input in a <em>collated</em> format: instead of a nested vector of vectors, we need a single ND-array. DataLoaders.jl provides the <a href="../docstrings/DataLoaders.collate.html"><code>collate</code></a> function for this:</p>
<pre><code cell="main" class="language-julia">DataLoaders.collate(batch)
</code></pre>
<pre><code class="plaintext cell-output cell-result" class="language-plaintext">2Ã—4 Array{Float64,2}:
 0.217023  0.242103  0.184852  0.358762
 0.400019  0.700758  0.61259   0.584284</code></pre>
<p>As you can see, the batch dimension is the last one by default.</p>
<h2 id="nested-observations"><a href="#nested-observations" class="anchor"></a>Nested observations</h2>
<p>The above case only shows how to collate observations that each consist of a single array. In practice, however, observations will often consist of multiple variables like input features and a target variable. For example, we could have an integer indicating the class of an input sample.</p>
<pre><code cell="main" class="language-julia">inputs = rand(2, 100)
targets = rand(1:10, 100)
data = (inputs, targets)
batch = [getobs(data, i) for i in 1:4]
</code></pre>
<pre><code class="plaintext cell-output cell-result" class="language-plaintext">4-element Array{Tuple{Array{Float64,1},Int64},1}:
 ([0.7455723945102726, 0.15030450788784844], 10)
 ([0.23938145846832604, 0.909149490229296], 6)
 ([0.07071602789317599, 0.30962249706295264], 10)
 ([0.24883340921316965, 0.30386956896196793], 1)</code></pre>
<p>Collating here also works, by keeping the tuple structure and collating each element separately:</p>
<pre><code cell="main" class="language-julia">DataLoaders.collate(batch)
</code></pre>
<pre><code class="plaintext cell-output cell-result" class="language-plaintext">([0.7455723945102726 0.23938145846832604 0.07071602789317599 0.24883340921316965; 0.15030450788784844 0.909149490229296 0.30962249706295264 0.30386956896196793], [10, 6, 10, 1])</code></pre>
<p>This is also implemented for <code>NamedTuple</code>s and <code>Dict</code>s. You can also collate nested structures, e.g. a <code>Tuple</code> of <code>Dict</code>s and the structure is preserved. This also works when using <a href="inplaceloading.html">inplace loading</a>.</p>
</article>
        <div id="page-navigation">
            <a id="previous-page" title="Previous" href="shuffling.html"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.2426 6.34317L14.8284 4.92896L7.75739 12L14.8285 19.0711L16.2427 17.6569L10.5858 12L16.2426 6.34317Z" fill="currentColor" /></svg></a>
            <a id="next-page" title="Next" href="inplaceloading.html"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.5858 6.34317L12 4.92896L19.0711 12L12 19.0711L10.5858 17.6569L16.2427 12L10.5858 6.34317Z" fill="currentColor" /></svg></a>
        </div>
    </main>
    <nav id="toc"><ul>
<li><a href="../README.html">Introduction</a></li>
<li><a href="../docs/overview.html">Overview</a></li>
<li><a href="../docs/setup.html">Installation</a></li>
<li><a href="../docs/datacontainers.html">Data containers</a></li>
<li><a href="../docs/shuffling.html">Shuffling, subsetting, splitting</a></li>
<li><a href="../docs/collate.html">Collating</a></li>
<li><a href="../docs/inplaceloading.html">Inplace loading</a></li>
<li><a href="../docs/interface.html">Data container interface</a></li>
<li><a href="../docs/ecosystem.html">Ecosystem</a></li>
<li><a href="../docs/quickstartpytorch.html">Comparison to PyTorch</a></li>
<li><a href="../docs/status.html">TODOs</a></li>
</ul>
</nav>
    <footer>
        Built with <a target="_blank" href="https://github.com/MichaelHatherly/Publish.jl">Publish.jl</a> and the <a target="_blank" href="https://julialang.org">Julia Language.</a>
    </footer>
    <script>hljs.initHighlightingOnLoad();</script>
</body>
</html>
